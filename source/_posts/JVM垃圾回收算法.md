---
title: JVM垃圾回收算法
date: 2020-09-06 22:52:04
tags: jvm
---


JAVA使用可达性算法判断对象是否可以回收.
在确定了哪些对象可回收后,接下来就是进行垃圾回收.下面讨论几种常见的垃圾回收算法

# 1标记清除算法(mark-sweep)
标记清除算法是最基础的收集算法,它分为两个阶段,第一阶段是`标记`,第二阶段是`清除`.
+ 标记 : 标记出所有需要回收的对象
+ 清除 : 回收所有被标记的对象

如图
![Alt text](/images/jvm_mark_sweep.png)

<!--more-->

标记清除算法有以下两个缺点
1 效率不高.标记清除两个阶段的效率都不高
2 空间碎片.标记清除后会产生大量不连续的内存碎片

# 2 复制算法(copying)
复制算法将可用内存划分为大小相同的两块区域.
每次只使用其中一块.当第一块s0的内存使用完毕,需要回收时,将活着的对象直接复制到第二块是s1上,然后清空之前使用的那一块s0内存.
如图
![Alt text](/images/jvm_copy.png)

复制算法实现简单,运行高效.但是内存使用率低,只有50%.

# 3 标记整理算法(mark-compact)
标记整理算法和标记清除算法类似,也是分为两个阶段.第一阶段`标记`,第二阶段是`整理并清除`
1 标记 : 标记出所有需要回收的对象
2 整理并清除 : 将所有存活的对象都向一端移动,然后直接清理边界以外的内存

如图
![Alt text](/images/jvm_mark_compact.png)

# 4 分代收集算法
分代垃圾回收算法的思想是按照对象存活周期不同,将内存划分为几块.将堆划分为新生代和老年代,根据不同年代对象的特点选择适应的算法.
如新生代,每次GC都有大量对象被回收,所以适合用`复制算法`.
老年代对象存活率高,使用`标记清除` 或者 `标记整理` 算法