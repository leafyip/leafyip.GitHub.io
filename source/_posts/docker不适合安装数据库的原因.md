---
title: docker不适合安装数据库的原因
date: 2020-09-17 20:51:52
tags: docker
---

## 1.数据安全问题
当容器被删除时，容器内的数据也会被删除。虽然docker可以挂载数据卷来存储数据，但docker 的volumes是围绕Union FS镜像来提供持久化存储，数据安全缺乏保证。
当容器崩溃或者数据库奔溃等，可能会损坏数据。

## 2.磁盘IO性能问题
数据库对磁盘操作频繁，如果一台docker部署多个mysql，会产生严重的IO瓶颈，降低数据库的性能。

## 3.网络问题
假如数据库都安装在物理机，那么只需要保证物理机之间的网络是互通的，数据库主从复制就可以顺利进行。
但docker是使用网络虚拟化，在数据库与物理机之前多了一层隔离层，如果docker网络有问题会影响主从复制。

<!--more-->

## 4.服务的状态
docker适合无状态的服务，但数据库是有状态的。将数据库放在docker中，它会使故障的范围增大。

## 5.资源隔离
docker使用cggroup实现资源限制，但只能限制自己已获得的资源。如果其他应用程序过度占用物理机的资源，严重时甚至导致容器停止服务。

## 6.数据库运行环境资源要求
假设数据库需要32G内存，如果安装在物理机中，理论上物理机也只需要32G内存就足够。但如果安装在docker上，物理机的所需的内存会远远大于32G，造成资源的浪费。